package com.codeforces.round630div2

/** http://codeforces.com/contest/1332/problem/B
  *
  * ### B. –ù–µ–ø—Ä–æ—Å—Ç–∞—è –ø–æ–∫—Ä–∞—Å–∫–∞
  *
  * –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤–Ω—ã–º, –µ—Å–ª–∏ –æ–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º–æ –≤ –≤–∏–¥–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –¥–≤—É—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—ã—Ö
  * —á–∏—Å–µ–ª, –∫–∞–∂–¥–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ 1. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–µ–¥—É—é—â–∏–µ —á–∏—Å–ª–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ: 6, 4, 120, 27. –°–ª–µ–¥—É—é—â–∏–µ —á–∏—Å–ª–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã–º–∏ –Ω–µ
  * —è–≤–ª—è—é—Ç—Å—è: 1, 2, 3, 17, 97.
  *
  * –ó–∞–¥–∞–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ n —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö —á–∏—Å–µ–ª a1, a2, ..., an.
  *
  * –ê–ª–∏—Å–∞ —Ö–æ—á–µ—Ç –≤—ã–±—Ä–∞—Ç—å –ª—é–±–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ m <= 11 –∏ –ø–æ–∫—Ä–∞—Å–∏—Ç—å –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –æ–¥–∏–Ω –∏–∑ ùëö —Ü–≤–µ—Ç–æ–≤ –æ—Ç 1 –¥–æ m —Ç–∞–∫, —á—Ç–æ:
  *   1. –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ü–≤–µ—Ç–∞ –æ—Ç 1 –¥–æ m —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç —ç—Ç–æ–≥–æ —Ü–≤–µ—Ç–∞; 2. –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ–∫—Ä–∞—à–µ–Ω –∏ –ø—Ä–∏—Ç–æ–º
  *      —Ä–æ–≤–Ω–æ –≤ –æ–¥–∏–Ω —Ü–≤–µ—Ç; 3. –Ω–∞–∏–±–æ–ª—å—à–∏–π –æ–±—â–∏–π –¥–µ–ª–∏—Ç–µ–ª—å –ª—é–±—ã—Ö –¥–≤—É—Ö –æ–¥–Ω–æ—Ü–≤–µ—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±–æ–ª—å—à–µ 1, —Ç–æ –µ—Å—Ç—å gcd(ai, aj)
  *      > 1 –¥–ª—è –ª—é–±–æ–π –ø–∞—Ä—ã –∏–Ω–¥–µ–∫—Å–æ–≤ i, j –µ—Å–ª–∏ —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–∫—Ä–∞—à–µ–Ω—ã –≤ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ü–≤–µ—Ç.
  *
  * –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–∫—Ä–∞—à–µ–Ω—ã –≤ —Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –æ—Ç 1 –¥–æ
  * n –Ω–∞–¥–æ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ m —Ü–≤–µ—Ç–æ–≤.
  *
  * –ê–ª–∏—Å–∞ —É–∂–µ –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –µ—Å–ª–∏ –≤—Å–µ ai <= 1000, —Ç–æ –æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É, –≤—ã–±—Ä–∞–≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ m <= 11.
  *
  * –ü–æ–º–æ–≥–∏—Ç–µ –ê–ª–∏—Å–µ –Ω–∞–π—Ç–∏ —Ç—Ä–µ–±—É–µ–º—É—é –ø–æ–∫—Ä–∞—Å–∫—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏
  * –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–π—Ç–∏ —Ä–µ—à–µ–Ω–∏—è —Å –ª—é–±—ã–º m –æ—Ç 1 –¥–æ 11.
  *
  * #### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∑–∞–ø–∏—Å–∞–Ω–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ t (1 <= t <= 1000) ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤
  * —Ç–µ—Å—Ç–µ. –î–∞–ª–µ–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è —Å–∞–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞–±–æ—Ä–æ–≤. –í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞–±–æ—Ä–∞ –∑–∞–ø–∏—Å–∞–Ω–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ n (1 <= n <= 1000) ‚Äî
  * –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ a. –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–∞–±–æ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç ùëõ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª a1,
  * a2, ..., an (4 <= ai <= 1000). –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Å—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π n –ø–æ –≤—Å–µ–º –Ω–∞–±–æ—Ä–∞–º –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç
  * 104.
  *
  * #### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã–≤–µ–¥–∏—Ç–µ 2 —Å—Ç—Ä–æ–∫–∏. –í –ø–µ—Ä–≤—É—é –≤—ã–≤–µ–¥–∏—Ç–µ m (1 <= m <= 11) ‚Äî
  * –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤. –°—á–∏—Ç–∞–π—Ç–µ, —á—Ç–æ —Ü–≤–µ—Ç–∞ –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω—ã –æ—Ç 1 –¥–æ m. –í–æ –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–æ–∫—É –≤—ã–≤–µ–¥–∏—Ç–µ –ª—é–±—É—é
  * —Ä–∞—Å–∫—Ä–∞—Å–∫—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è–º –≤—ã—à–µ. –í—ã–≤–µ–¥–∏—Ç–µ n —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª c1, c2, ..., cn (1 <= ci <= m), –≥–¥–µ
  * ci - —Ü–≤–µ—Ç i-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –ï—Å–ª–∏ —Ä–µ—à–µ–Ω–∏–π –Ω–µ—Å–∫–æ–ª—å–∫–æ, —Ç–æ –≤—ã–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–µ –∏–∑ –Ω–∏—Ö. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ
  * –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–π—Ç–∏ —Ä–µ—à–µ–Ω–∏—è —Å –ª—é–±—ã–º m –æ—Ç 1 –¥–æ 11.
  *
  * –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ü–≤–µ—Ç –æ—Ç 1 –¥–æ m –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ö–æ—Ç—è –±—ã —Ä–∞–∑. –õ—é–±—ã–µ –¥–≤–∞ –æ–¥–Ω–æ—Ü–≤–µ—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–æ–ª–∂–Ω—ã –Ω–µ
  * –±—ã—Ç—å –≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç—ã (—Ç–æ –µ—Å—Ç—å –∏—Ö –ù–û–î –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 1).
  */
object B extends App {
  private val ps = List(31, 29, 23, 19, 17, 13, 11, 7, 5, 3, 2)

  private def colorize(ns: List[Int]): List[Int] = {

    val cs = ns.foldLeft(List.empty[Int]) { (cs, n) =>
      val p = ps.find(n % _ == 0).get

      p :: cs
    }

    val p2c = Map(cs.distinct.zipWithIndex: _*)

    cs.map(1 + p2c(_)).reverse
  }

  val t = scala.io.StdIn.readInt()

  val input: List[List[Int]] = (0 until t)
    .foldLeft(List.empty[List[Int]]) { case (input, _) =>
      val _  = scala.io.StdIn.readInt()
      val ns = scala.io.StdIn.readLine().split(" ").map(_.toInt).toList

      ns :: input
    }
    .reverse

  val output = input.map(colorize)

  output.foreach { cs =>
    println(cs.distinct.length)
    println(cs.mkString(" "))
  }
}
